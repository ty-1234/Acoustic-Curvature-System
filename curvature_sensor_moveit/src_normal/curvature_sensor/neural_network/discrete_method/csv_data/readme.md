## 📊 Data and Filenaming Convention

The dataset for this project involves a two-stage preprocessing pipeline. The initial "merged" CSV files, which combine raw robot and acoustic data, are the starting point for the data cleaning and model training processes described here.

---

### Input Data: `merged_*.csv` Files

The data used for training our curvature prediction models originates from files generated by an initial synchronization script (`csv_sync.py`). These files are located in the `csv_data/merged/` directory.

#### 🔤 Filename Structure: `merged_<CURVATURE_STR>[TEST_SESSION_ID].csv`

Each filename encodes key experimental parameters:

| Element             | Meaning                                                                    | Example in `merged_0_01[test 1].csv` |
|---------------------|----------------------------------------------------------------------------|--------------------------------------|
| `merged_`           | Prefix indicating the file is a result of raw data synchronization.        | `merged_`                            |
| `<CURVATURE_STR>`   | The nominal target curvature value for that experimental setup. Decimal points in the curvature value are replaced by underscores. | `0_01` (representing 0.01 m⁻¹)     |
| `[TEST_SESSION_ID]` | An identifier for the specific experimental run or session (e.g., `[test 1]`, `[test 2]`, etc.). We conduct four repeated runs for each curvature profile. | `[test 1]`                         |

**Example Files from `csv_data/merged/`:**
* `merged_0_005[test 1].csv` (Nominal curvature 0.005 m⁻¹, Run 1)
* `merged_0_01818[test 3].csv` (Nominal curvature 0.01818 m⁻¹, Run 3)

> 💡 **Important Note on Curvature Values**: While the filename contains a nominal `<CURVATURE_STR>`, the actual precise curvature values used for training and analysis are sourced directly from the `Curvature` column within each CSV file during periods of active sensor engagement (`Curvature_Active == 1`).

**Dataset Composition:**
We utilize data from **5 distinct nominal curvature profiles**:
* `0.005` m⁻¹
* `0.007142` m⁻¹
* `0.01` m⁻¹
* `0.01818` m⁻¹
* `0.05` m⁻¹

For each of these curvature profiles, **4 repeated experimental runs/sessions** (`[test 1]` through `[test 4]`) were conducted. This results in a total of `5 curvatures * 4 runs = 20` `merged_*.csv` files, providing a diverse dataset for model development.

Each `merged_*.csv` file contains time-synchronized columns including:
- `FFT_200Hz` to `FFT_2000Hz` (acoustic frequency band amplitudes)
- `Timestamp`
- `Curvature` (the ground truth value, set to 0.0 when not active)
- `Curvature_Active` (`1` if the sensor is actively being pressed, `0` otherwise)
- `Position_cm` (the robot's pressing location, 0–5 cm, during active periods)

---

### 🧹 Stage 2: Noise Removal & Segment Cleaning (`noise_remover.py`)

The `merged_*.csv` files are then processed by `noise_remover.py` (which contains the `process_data_for_discrete_extraction` function). This script is crucial for refining the data for model training.

#### ✂️ Key Operations:
- Identifies all distinct "active blocks" (segments where `Curvature_Active == 1`).
- For each active block:
  - **Leading Noise Deletion**: Deletes approximately 1 second worth of data rows immediately *before* the block's start (these are typically inactive, `Curvature_Active == 0`, rows).
  - **Trailing Active Data Deletion**: Deletes the last ~1 second worth of data rows *from within the active block itself*. This is intended to remove potential noise associated with the sensor's release or stabilization phase while ensuring the model trains on stable active readings. If an active block is 1 second long or shorter, this step results in the deletion of that entire active segment.
- For the remaining segments of active blocks:
  - Standardizes `Curvature`: Sets the `Curvature` column to a constant value, using the curvature recorded at the *original start* of that active block from the input `merged_*.csv` file.
  - Preserves `Position_cm`: Ensures `Position_cm` reflects the original robot-reported position for those measurements.
  - Recalculates `Curvature_Active`: Updates this flag based on the processed `Curvature` values (e.g., active if `Curvature > small_threshold`).

#### 📤 Output Format (from `noise_remover.py`)
Cleaned files are saved in the `csv_data/cleaned/` directory with the naming convention:
`cleaned_<CURVATURE_STR>[TEST_SESSION_ID].csv`

Examples:
- `cleaned_0_007142[test 2].csv`
- `cleaned_0_01818[test 4].csv`

These `cleaned_*.csv` files are the direct input for training subsequent curvature prediction models, such as the Gaussian Process Regression (GPR) model in `RQ_GPR_train.py`.

---

### 📦 Data Processing Summary Table

| Pipeline Stage             | Input Script         | Input Folder & Pattern                      | Output Folder & Pattern                        | Key Transformation                                                                                                |
|----------------------------|----------------------|---------------------------------------------|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| 1. (Source Data)         | `csv_sync.py`        | `csv_data/raw/{audio_fft,robot}/raw_*`      | `csv_data/merged/merged_<CURVATURE_STR>[TEST_SESSION_ID].csv` | *Initial synchronization of raw audio and robot data (details in `csv_sync.py` documentation).* |
| 2. Noise/Segment Cleaning  | `noise_remover.py`   | `csv_data/merged/merged_<CURVATURE_STR>[TEST_SESSION_ID].csv` | `csv_data/cleaned/cleaned_<CURVATURE_STR>[TEST_SESSION_ID].csv` | Refines active data segments by targeted deletions; standardizes `Curvature` within remaining active portions. |

---